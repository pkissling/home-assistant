---

lights_ambient_turn_on:
  mode: restart
  variables:
    transition: 0
  sequence:
    - service: light.turn_on
      entity_id: light.bedroom_wardrobe
      data:
        brightness: 100
        transition: "{{ transition }}"
    - choose:
        - conditions:
            condition: state
            entity_id: input_boolean.tv_mode
            state: 'on'
          sequence:
            - service: light.turn_on
              entity_id: light.living_room
              data:
                brightness: 80
                transition: "{{ transition }}"
            - service: input_text.set_value
              entity_id: input_text.old_brightness_living_room_couch
              data:
                value: 255
            - service: input_text.set_value
              entity_id: input_text.old_brightness_living_room_tv
              data:
                value: 130
      default:
        - service: light.turn_on
          entity_id: light.living_room
          data:
            brightness: 255
            transition: "{{ transition }}"
        - service: light.turn_on
          entity_id: light.living_room_tv
          data:
            brightness: 180
            transition: "{{ transition }}"
    - service: light.turn_on
      entity_id: light.corridor_sideboard
      data:
        brightness: 50
        transition: "{{ transition }}"
    - choose:
        - conditions:
            condition: state
            entity_id: switch.guest_mode
            state: 'off'
          sequence:
            service: light.turn_on
            entity_id: light.study_shelf
            data:
              brightness: 50
              transition: "{{ transition }}"
    # keep script in state 'on' until script finished
    - delay:
        seconds: "{{ transition }}"

lights_ambient_turn_off:
  mode: restart
  variables:
    transition: 0
  sequence:
    - service: switch.turn_off
      entity_id:
        - switch.adaptive_lighting_bedroom
        - switch.adaptive_lighting_corridor
        - switch.adaptive_lighting_living_room
        - switch.adaptive_lighting_study
    - service: light.turn_off
      entity_id: light.ambient
      data:
        transition: "{{ transition }}"
    - choose:
        - conditions:
            condition: state
            entity_id: switch.guest_mode
            state: 'off'
          sequence:
            service: light.turn_off
            entity_id: light.study_floor_lamp
            data:
              transition: "{{ transition }}"
    # keep script in state 'on' until script finished
    - delay:
        seconds: "{{ transition }}"
    - wait_for_trigger:
        platform: state
        entity_id: light.ambient
        to: 'off'
      timeout:
        minutes: 10
    - service: light.turn_off
      entity_id: light.ambient
    - service: switch.turn_on
      entity_id:
        - switch.adaptive_lighting_bedroom
        - switch.adaptive_lighting_corridor
        - switch.adaptive_lighting_living_room
        - switch.adaptive_lighting_study
