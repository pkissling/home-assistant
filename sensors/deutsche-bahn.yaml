---

- platform: deutsche_bahn
  from: Harras, München
  to: Hauptbahnhof, München
  only_direct: true
  offset: 600  # 10 mins

- platform: deutsche_bahn
  from: Harras, München
  to: Sendlinger Tor, München
  only_direct: true
  offset: 720  # 12 mins

- platform: deutsche_bahn
  from: Harras, München
  to: Marienplatz, München
  only_direct: true
  offset: 600  # 10 mins

- platform: template
  sensors:

    departure_s7_to_hauptbahnhof:
      friendly_name: S7 - Hauptbahnhof
      value_template: >
        {% set departure = strptime(state_attr('sensor.harras_munchen_to_hauptbahnhof_munchen', 'departure'), '%H:%M') %}
        {% set delay =  state_attr('sensor.harras_munchen_to_hauptbahnhof_munchen', 'delay') %}
        {% set departure_with_delay = (departure + timedelta(minutes=delay)).strftime('%H:%M') %}
        {{ departure_with_delay }} & {{ state_attr('sensor.harras_munchen_to_hauptbahnhof_munchen', 'next') }}
    departure_u6_to_sendlinger_tor:
      friendly_name: U6 - Sendlinger Tor
      value_template: >
        {% set departure = strptime(state_attr('sensor.harras_munchen_to_sendlinger_tor_munchen', 'departure'), '%H:%M') %}
        {% set delay =  state_attr('sensor.harras_munchen_to_sendlinger_tor_munchen', 'delay') %}
        {% set departure_with_delay = (departure + timedelta(minutes=delay)).strftime('%H:%M') %}
        {{ departure_with_delay }} & {{ state_attr('sensor.harras_munchen_to_sendlinger_tor_munchen', 'next') }}
    departure_s7_to_marienplatz:
      friendly_name: S7 - Marienplatz
      value_template: >
        {% set departure = strptime(state_attr('sensor.harras_munchen_to_marienplatz_munchen', 'departure'), '%H:%M') %}
        {% set delay =  state_attr('sensor.harras_munchen_to_marienplatz_munchen', 'delay') %}
        {% set departure_with_delay = (departure + timedelta(minutes=delay)).strftime('%H:%M') %}
        {{ departure_with_delay }} & {{ state_attr('sensor.harras_munchen_to_marienplatz_munchen', 'next') }}
